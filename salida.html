<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>San Juan River Safety Guide</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        html, body { 
            height: 100%; 
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Roboto', sans-serif;
            background: radial-gradient(ellipse at center, rgba(255,254,234,1) 0%, rgba(255,254,234,1) 35%, #B7E8EB 100%);
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .safety-indicators {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .indicator {
            background-color: rgba(236, 240, 241, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin: 10px;
            text-align: center;
            width: 45%;
        }
        .gauge {
            width: 200px;
            height: 100px;
            margin: 0 auto;
            background-color: #bdc3c7;
            border-radius: 100px 100px 0 0;
            position: relative;
            overflow: hidden;
        }
        .gauge-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            transition: height 0.5s;
        }
        .gauge-cover {
            width: 180px;
            height: 90px;
            background-color: white;
            border-radius: 90px 90px 0 0;
            position: absolute;
            top: 10px;
            left: 10px;
        }
        .gauge-value {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
        }
        .flow-rate {
            margin-top: 15px;
            font-size: 16px;
        }
        #loading {
            text-align: center;
            font-size: 18px;
            margin-top: 20px;
        }
        .ocean { 
            height: 5%;
            width: 100%;
            position: fixed;
            bottom: 0;
            left: 0;
            background: #015871;
        }
        .wave {
            background: url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/85486/wave.svg) repeat-x; 
            position: absolute;
            top: -198px;
            width: 6400px;
            height: 198px;
            animation: wave 7s cubic-bezier(0.36, 0.45, 0.63, 0.53) infinite;
            transform: translate3d(0, 0, 0);
        }
        .wave:nth-of-type(2) {
            top: -175px;
            animation: wave 7s cubic-bezier(0.36, 0.45, 0.63, 0.53) -.125s infinite, swell 7s ease -1.25s infinite;
            opacity: 1;
        }
        @keyframes wave {
            0% { margin-left: 0; }
            100% { margin-left: -1600px; }
        }
        @keyframes swell {
            0%, 100% { transform: translate3d(0,-25px,0); }
            50% { transform: translate3d(0,5px,0); }
        }
        .article {
            margin-top: 30px;
        }
        .article h2 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .article p {
            margin-bottom: 15px;
        }
        .legend {
            background-color: rgba(236, 240, 241, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .legend h3 {
            margin-top: 0;
            text-align: center;
        }
        .legend ul {
            list-style-type: none;
            padding: 0;
        }
        .legend li {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .legend .color-indicator {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        @media (max-width: 600px) {
            .indicator {
                width: 100%;
            }
            .gauge {
                width: 100px;
                height: 50px;
            }
            .gauge-cover {
                width: 90px;
                height: 45px;
            }
            .gauge-value {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>San Juan River Safety Guide</h1>
        <div class="safety-indicators">
            <div class="indicator">
                <h2>Current Streamflow (CFS)</h2>
                <div class="gauge">
                    <div id="cfs-gauge-fill" class="gauge-fill"></div>
                    <div class="gauge-cover"></div>
                    <div id="cfs-gauge-value" class="gauge-value"></div>
                </div>
                <div id="cfs-flow-rate" class="flow-rate"></div>
            </div>
        </div>
        <div id="loading">Loading river data...</div>

        <!-- Article Section -->
        <div class="article">
            <h2>Scout Wave - Know the Flow and When to Go</h2>
            <p><strong>November 16, 2023 • Mike Harvey</strong></p>
            <p>Not ready to put up those surfboards just yet? We’re here to give you the rundown on river flows and gauges so you know the best times to get out there and keep surfing. The Scout Wave in Salida, Colorado was designed to work at the lower range of flows. The Upper Arkansas River is blessed with higher flows than many rivers in Colorado because it serves as the west to east conduit for moving water to Front Range farmers, ranchers, and cities. So let's go over how to understand if the wave is in or not so you can plan your surfing.</p>
            <p><strong>Understanding River Flows in Salida</strong></p>
            <p>River flows are measured in cubic feet per second (CFS). The Arkansas River is controlled to some degree through releases of west slope water into high mountain reservoirs like Twin Lakes and Clear Creek. Then water is released down those tributaries into the Ark. Flows change, very often on a daily basis, based on variables including calls for water by downstream water users, snowpack/snow melt, and rainfall.</p>
            <p><strong>What does this mean for surfing?</strong></p>
            <p>The Scout wave performs best between 300-1500 CFS. Too far below 300 and you spend most of your surf trying not to flush out, but diehards with high volume boards surf down to 250 CFS. Starting around 350 CFS, get ready to bust out those foamies and lower volume boards and rip some turns! Over 400 CFS is game on. Based on our first year of surfing the wave, a flow rate of about 1100 CFS is the most prime, drop-everything-call-in-sick, level.</p>
        </div>

        <!-- Legend Section -->
        <div class="legend">
            <h3>Scout Wave Flow Legend</h3>
            <ul>
                <li><span class="color-indicator" style="background-color: #ff0000;"></span>250 CFS: Too low unless you are a sicko. Higher volume boards.</li>
                <li><span class="color-indicator" style="background-color: #ff4500;"></span>300 CFS: Minimum Flow. Bring the foamies.</li>
                <li><span class="color-indicator" style="background-color: #ffa500;"></span>350 CFS: It's getting good. Can ride most shortboards like the Wave Farmer.</li>
                <li><span class="color-indicator" style="background-color: #ffff00;"></span>400-800 CFS: It's really good.</li>
                <li><span class="color-indicator" style="background-color: #008000;"></span>800-1100 CFS: It's really really good.</li>
                <li><span class="color-indicator" style="background-color: #0000ff;"></span>1100-1500 CFS: Still super fun, but swim is a little more intense.</li>
                <li><span class="color-indicator" style="background-color: #000080;"></span>Over 1500 CFS: Too high, wave starts to foam out.</li>
            </ul>
        </div>
    </div>

    <div class="ocean">
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <script>
        const SITE_CODE = '07091200'; // USGS site code for the river

        async function fetchCFSData() {
            const url = `https://waterservices.usgs.gov/nwis/iv/?format=json&sites=${SITE_CODE}&parameterCd=00060`;

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error("Failed to fetch data");
                }
                const data = await response.json();

                // Extract the current CFS value
                const cfsValue = parseFloat(data.value.timeSeries[0].values[0].value[0].value);
                const dateTime = data.value.timeSeries[0].values[0].value[0].dateTime;

                // Update the gauge and display
                updateGauge(cfsValue, dateTime);
                document.getElementById('loading').style.display = 'none';
            } catch (error) {
                console.error("Error fetching CFS data:", error);
                document.getElementById('loading').textContent = 'Error loading data. Please try again later.';
            }
        }

        function updateGauge(cfsValue, dateTime) {
            const gaugeFill = document.getElementById('cfs-gauge-fill');
            const gaugeValue = document.getElementById('cfs-gauge-value');
            const flowRateElement = document.getElementById('cfs-flow-rate');

            // Set gauge height (scaled to a max of 1500 CFS for visualization)
            const maxCFS = 1500;
            const height = Math.min((cfsValue / maxCFS) * 100, 100);

            gaugeFill.style.height = `${height}%`;
            gaugeFill.style.backgroundColor = getColorForCFS(cfsValue);
            gaugeValue.textContent = `${cfsValue} CFS`;
            flowRateElement.innerHTML = `Current flow rate: ${cfsValue} CFS<br>Last updated: ${new Date(dateTime).toLocaleString()}`;
        }

        function getColorForCFS(cfsValue) {
            if (cfsValue < 300) return '#ff0000'; // Red for low flow
            if (cfsValue < 400) return '#ff4500'; // Orange for moderate flow
            if (cfsValue < 800) return '#ffa500'; // Yellow for high flow
            if (cfsValue < 1100) return '#ffff00'; // Light green for very high flow
            if (cfsValue < 1500) return '#008000'; // Green for prime flow
            return '#000080'; // Blue for extreme flow
        }

        // Fetch data when the page loads
        fetchCFSData();
        setInterval(fetchCFSData, 900000); // Update every 15 minutes
    </script>
</body>
</html>
